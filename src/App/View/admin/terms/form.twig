{% extends 'admin/layout.twig' %}

{% import 'admin/partials/components.twig' as ui %}
{% import 'admin/partials/meta_fields.twig' as meta_fields %}

{% set current_menu = 'terms' %}

{% block title %}{{ heading }} | Administrace{% endblock %}

{% block body %}
    <h1 class="h3 mb-4">{{ heading }}</h1>

    <form method="post" action="{{ form_action }}" class="mb-3" id="termForm">
        <div class="card shadow-sm mb-3">
            <div class="card-body p-4">
                <input type="hidden" name="type" value="{{ values.type }}">

                <div class="mb-3">
                    <label for="name" class="form-label">Název</label>
                    <input type="text" name="name" id="name" class="form-control {% if errors.name %}is-invalid{% endif %}" value="{{ values.name }}">
                    {% if errors.name %}
                        <div class="invalid-feedback">{{ errors.name }}</div>
                    {% endif %}
                </div>

                <div class="mb-3">
                    <label for="slug" class="form-label">Slug</label>
                    <input type="text" name="slug" id="slug" class="form-control {% if errors.slug %}is-invalid{% endif %}" value="{{ values.slug }}" placeholder="např. moja-kategorie">
                    {% if errors.slug %}
                        <div class="invalid-feedback">{{ errors.slug }}</div>
                    {% else %}
                        <div class="form-text">Pokud necháš prázdné, vytvoří se automaticky z názvu.</div>
                    {% endif %}
                </div>

                <div class="mb-3">
                    <label for="description" class="form-label">Popis</label>
                    <textarea name="description" id="description" rows="5" class="form-control">{{ values.description }}</textarea>
                </div>
            </div>
        </div>

        {{ meta_fields.fields(meta_keys, meta_values, {
            title: 'Meta údaje',
            help: 'Přidej doplňkové informace k termu. Prázdné hodnoty se neuloží.',
            show_empty: true
        }) }}

        <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
            {{ ui.back_button('/admin/terms/type/' ~ values.type, { label: 'Zpět' }) }}
            {{ ui.actions([
                {
                    type: 'button',
                    button_type: 'submit',
                    label: 'Uložit',
                    variant: 'primary',
                    icon: 'bi-save'
                }
            ]) }}
        </div>
    </form>

    {% if term_id is defined %}
        <div class="text-end">
            {{ ui.actions([
                {
                    type: 'form',
                    action: '/admin/terms/' ~ term_id ~ '/delete',
                    label: 'Smazat',
                    variant: 'danger',
                    icon: 'bi-trash',
                    confirm: 'Opravdu smazat tento term?'
                }
            ]) }}
        </div>
    {% endif %}
{% endblock %}
